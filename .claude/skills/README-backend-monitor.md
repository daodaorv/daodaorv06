# 叨叨房车后端自动巡检工作流工具使用说明

## 功能概述

这个工具是一个自动化的后端开发助手，它会：

1. **持续监控**: 自动检测前端API文档的状态变化
2. **智能分析**: 分析已完成的API需求和规范
3. **自动生成**: 生成对应的后端路由、控制器和服务文件
4. **集成测试**: 自动编译和测试生成的代码
5. **状态更新**: 更新API文档中的集成状态

## 使用方法

### 1. 安装和启动

```bash
# 进入项目根目录
cd e:\VMwareShare\daodao

# 启动自动监控工具
node .claude\skills\backend-auto-monitor.js
```

### 2. 工作流程

1. **启动监控**: 工具会扫描所有前端项目的API文档
2. **实时检测**: 每5秒检查一次API文档中的 ✅ 标记
3. **自动处理**: 当检测到新的已开发API时，自动执行：
   - 分析API需求（方法、端点、参数、响应）
   - 检查后端是否已实现
   - 如未实现，自动生成完整代码
   - 编译测试生成的代码
   - 更新API状态为"已集成"

### 3. 监控界面

工具会实时显示：
- 当前时间
- 运行时长
- 统计信息（检测API数、完成任务数、成功集成数）
- 当前处理状态
- 任务队列情况
- 最近处理的API列表

### 4. 日志系统

- 控制台输出：带颜色的实时日志
- 文件输出：`.claude/logs/backend-monitor-YYYY-MM-DD.log`
- 统计信息：`.claude/logs/stats-YYYY-MM-DD.json`

## 支持的前端项目

- **admin-console**: PC管理端
- **miniprogram**: 小程序端
- **mobile-admin**: 移动管理端

## 生成的后端文件结构

对于每个检测到的API，工具会在 `backend/src/` 目录下生成：

```
backend/src/
├── routes/
│   └── api-name.routes.ts     # 路由定义
├── controllers/
│   └── api-name.controller.ts # 控制器逻辑
└── services/
    └── api-name.service.ts    # 业务逻辑
```

## 安全退出

按 `Ctrl+C` 可安全停止监控，工具会：
- 优雅关闭正在处理的任务
- 保存当前统计信息
- 记录关闭日志

## 配置选项

可以在工具代码中修改以下配置：

```javascript
this.scanInterval = 5000;        // 扫描间隔（毫秒）
this.frontendProjects = [...];   // 监控的前端项目列表
```

## 注意事项

1. **环境要求**: Node.js >= 18.18.0
2. **项目结构**: 确保后端项目结构完整
3. **API文档**: 前端API文档必须包含 ✅ 标记来标识已开发状态
4. **代码规范**: 生成的代码遵循项目现有的代码风格

## 故障排除

### 常见问题

1. **启动失败**: 检查后端项目结构是否完整
2. **文件权限**: 确保有写入 `.claude/logs/` 目录的权限
3. **编译错误**: 检查生成的TypeScript代码语法

### 调试方法

1. 查看日志文件获取详细错误信息
2. 检查生成的代码是否符合项目规范
3. 手动测试生成的API接口

## 更新日志

### v1.0.0
- 初始版本发布
- 支持自动监控和代码生成
- 集成测试和状态更新功能