# å¨å¨æˆ¿è½¦å°ç¨‹åºç»„ä»¶ä½¿ç”¨ç¤ºä¾‹

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0 | **åˆ›å»ºæ—¶é—´**: 2025-11-24 | **ç»´æŠ¤å›¢é˜Ÿ**: å¨å¨æˆ¿è½¦æŠ€æœ¯å›¢é˜Ÿ

> ğŸ“– **æœ¬æ–‡æ¡£æä¾›ç»„ä»¶çš„å®é™…ä½¿ç”¨åœºæ™¯å’Œå®Œæ•´ä»£ç ç¤ºä¾‹**ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€ŸæŒæ¡ç»„ä»¶çš„æ­£ç¡®ä½¿ç”¨æ–¹æ³•ã€‚

---

## ğŸ“‹ ç¤ºä¾‹ç›®å½•

1. [é¡µé¢çº§ç»„ä»¶ç¤ºä¾‹](#1-é¡µé¢çº§ç»„ä»¶ç¤ºä¾‹)
2. [ä¸šåŠ¡ç»„ä»¶ç»„åˆç¤ºä¾‹](#2-ä¸šåŠ¡ç»„ä»¶ç»„åˆç¤ºä¾‹)
3. [åŸºç¡€ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹](#3-åŸºç¡€ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹)
4. [å¸¸è§åœºæ™¯è§£å†³æ–¹æ¡ˆ](#4-å¸¸è§åœºæ™¯è§£å†³æ–¹æ¡ˆ)
5. [æ€§èƒ½ä¼˜åŒ–å®ä¾‹](#5-æ€§èƒ½ä¼˜åŒ–å®ä¾‹)

---

## 1. é¡µé¢çº§ç»„ä»¶ç¤ºä¾‹

### 1.1 é¦–é¡µå®Œæ•´ç¤ºä¾‹

```vue
<template>
  <view class="home-page">
    <!-- é¡¶éƒ¨å…¬å‘Šæ  -->
    <NoticeBanner
      :notices="noticeList"
      :height="80"
      @notice-click="handleNoticeClick"
    />

    <!-- è½®æ’­å¹¿å‘Š -->
    <swiper
      class="banner-swiper"
      indicator-dots
      autoplay
      interval="5000"
      duration="300"
    >
      <swiper-item v-for="(banner, index) in bannerList" :key="index">
        <image
          :src="banner.image"
          mode="aspectFill"
          class="banner-image"
          @click="handleBannerClick(banner)"
        />
      </swiper-item>
    </swiper>

    <!-- æˆ¿è½¦é¢„è®¢æ¨¡å— -->
    <view class="booking-section">
      <view class="section-title">æˆ¿è½¦é¢„è®¢</view>
      <VehicleBooking
        :booking-data="bookingData"
        :stores="storeList"
        :show-return-store="false"
        @booking-change="handleBookingChange"
        @submit-click="handleSearchVehicles"
      />
    </view>

    <!-- é‡‘åˆšåŒºåŠŸèƒ½å…¥å£ -->
    <ServiceGrid
      :services="serviceList"
      :columns="3"
      :gap="20"
      :icon-size="48"
      @service-click="handleServiceClick"
    />

    <!-- è¥é”€å¼•å¯¼åŒº -->
    <view class="marketing-section">
      <!-- PLUSä¼šå‘˜æ¨å¹¿ -->
      <uni-card
        v-if="!isPlusMember"
        title="å¼€é€šPLUSä¼šå‘˜"
        :is-shadow="true"
        class="marketing-card"
        @click="goToPlusMember"
      >
        <view class="plus-benefits">
          <view class="benefit-item">
            <uni-icons type="checkmarkempty" color="#FFD700" size="16" />
            <text>æˆ¿è½¦ç§Ÿèµ95æŠ˜</text>
          </view>
          <view class="benefit-item">
            <uni-icons type="checkmarkempty" color="#FFD700" size="16" />
            <text>å…è´¹å–æ¶ˆè®¢å•</text>
          </view>
          <view class="benefit-item">
            <uni-icons type="checkmarkempty" color="#FFD700" size="16" />
            <text>ä¸“å±å®¢æœæœåŠ¡</text>
          </view>
        </view>
        <template v-slot:actions>
          <button size="mini" type="primary">ç«‹å³å¼€é€š</button>
        </template>
      </uni-card>

      <!-- ä¼˜æƒ åˆ¸ä¸­å¿ƒ -->
      <uni-card
        title="é¢†åˆ¸ä¸­å¿ƒ"
        :extra="`${availableCouponCount}å¼ å¯é¢†`"
        :is-shadow="true"
        class="marketing-card"
        @click="goToCouponCenter"
      >
        <view class="coupon-preview">
          <view v-for="coupon in couponPreview" :key="coupon.id" class="coupon-item">
            <uni-tag
              :text="coupon.type"
              :type="coupon.type === 'æ»¡å‡åˆ¸' ? 'error' : 'primary'"
              size="mini"
            />
            <text class="coupon-desc">{{ coupon.description }}</text>
          </view>
        </view>
      </uni-card>
    </view>

    <!-- æ¨èå†…å®¹åŒº -->
    <view class="recommend-section">
      <!-- ç¤¾åŒºå†…å®¹æ¨è -->
      <view class="recommend-block">
        <view class="block-title">
          <text>çƒ­é—¨æ”»ç•¥</text>
          <text class="more-link" @click="goToCommunity">æ›´å¤š ></text>
        </view>
        <view class="content-waterfall">
          <WaterfallItem
            v-for="item in contentList"
            :key="item.id"
            :item="item"
            :width="345"
            :gap="10"
            @item-click="goToContentDetail"
          />
        </view>
      </view>

      <!-- ä¼—ç­¹é¡¹ç›®æ¨è -->
      <view class="recommend-block">
        <view class="block-title">
          <text>ä¼˜è´¨é¡¹ç›®</text>
          <text class="more-link" @click="goToCrowdfunding">æ›´å¤š ></text>
        </view>
        <view class="project-list">
          <ProjectCard
            v-for="project in projectList"
            :key="project.id"
            :project="project"
            :show-progress="true"
            @project-click="goToProjectDetail"
            @support-click="handleSupportProject"
          />
        </view>
      </view>
    </view>
  </view>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'

// é¡µé¢æ•°æ®
const noticeList = ref([
  {
    id: 1,
    title: 'æ–°ç”¨æˆ·ç¦åˆ©',
    content: 'é¦–æ¬¡é¢„è®¢äº«9æŠ˜ä¼˜æƒ ï¼Œç«‹å³æŸ¥çœ‹è¯¦æƒ…',
    url: '/pages/activity/new-user'
  }
])

const bannerList = ref([
  {
    id: 1,
    image: 'https://example.com/banner1.jpg',
    url: '/pages/activity/summer-sale',
    title: 'å¤å­£ç‰¹æƒ æ´»åŠ¨'
  }
])

const bookingData = ref({
  pickupCity: '',
  pickupStore: '',
  pickupDate: '',
  pickupTime: '10:00',
  returnDate: '',
  returnTime: '18:00'
})

const serviceList = ref([
  { id: 1, name: 'ç‰¹æƒ ç§Ÿè½¦', icon: 'car', color: '#FF9F29', url: '/pages/special-offer/index' },
  { id: 2, name: 'è¥åœ°é¢„å®š', icon: 'location', color: '#007AFF', url: '/pages/camping/index' },
  { id: 3, name: 'æˆ¿è½¦æ—…æ¸¸', icon: 'paperplane', color: '#4CD964', url: '/pages/travel/index' },
  { id: 4, name: 'æˆ¿è½¦ä¼—ç­¹', icon: 'heart', color: '#DD524D', url: '/pages/crowdfunding/index' },
  { id: 5, name: 'ä¼˜æƒ åˆ¸', icon: 'gift', color: '#FF9F29', url: '/pages/coupon/list' },
  { id: 6, name: 'PLUSä¼šå‘˜', icon: 'vip', color: '#FFD700', url: '/pages/vip/index' }
])

const contentList = ref([
  {
    id: 1,
    title: 'æˆ¿è½¦è¥¿åŒ—å¤§ç¯çº¿å®Œæ•´æ”»ç•¥',
    content: '15å¤©æˆ¿è½¦è¥¿åŒ—å¤§ç¯çº¿ï¼Œè¯¦ç»†è·¯ä¹¦å’Œè¥åœ°æ¨è...',
    images: ['https://example.com/content1.jpg'],
    author: { name: 'æ—…è¡Œè¾¾äºº', avatar: 'https://example.com/avatar.jpg' },
    stats: { likes: 234, comments: 45 }
  }
])

const projectList = ref([
  {
    id: 1,
    name: 'å¥”é©°Cå‹æˆ¿è½¦ä¼—ç­¹é¡¹ç›®',
    description: 'é«˜ç«¯æˆ¿è½¦æŠ•èµ„é¡¹ç›®ï¼Œé¢„æœŸå¹´åŒ–æ”¶ç›Š8-12%',
    targetAmount: 1000000,
    currentAmount: 680000,
    annualReturn: '8-12%',
    image: 'https://example.com/project1.jpg'
  }
])

// è®¡ç®—å±æ€§
const isPlusMember = computed(() => {
  return false // å®é™…é¡¹ç›®ä¸­ä»ç”¨æˆ·çŠ¶æ€è·å–
})

const availableCouponCount = computed(() => {
  return 5 // å®é™…é¡¹ç›®ä¸­ä»APIè·å–
})

const couponPreview = computed(() => {
  return [
    { id: 1, type: 'æ»¡å‡åˆ¸', description: 'æ»¡1000å‡100' },
    { id: 2, type: 'æŠ˜æ‰£åˆ¸', description: 'æˆ¿è½¦ç§Ÿèµ95æŠ˜' }
  ]
})

// æ–¹æ³•
const handleNoticeClick = (notice: any) => {
  uni.navigateTo({ url: notice.url })
}

const handleBannerClick = (banner: any) => {
  uni.navigateTo({ url: banner.url })
}

const handleBookingChange = (data: any) => {
  bookingData.value = { ...bookingData.value, ...data }
}

const handleSearchVehicles = (data: any) => {
  // éªŒè¯å¿…å¡«å­—æ®µ
  if (!data.pickupCity || !data.pickupStore || !data.pickupDate || !data.returnDate) {
    uni.showToast({
      title: 'è¯·å®Œå–„é¢„è®¢ä¿¡æ¯',
      icon: 'none'
    })
    return
  }

  // è·³è½¬åˆ°è½¦è¾†åˆ—è¡¨é¡µ
  const params = encodeURIComponent(JSON.stringify(data))
  uni.navigateTo({
    url: `/pages/vehicles/index?data=${params}`
  })
}

const handleServiceClick = (service: any) => {
  uni.navigateTo({ url: service.url })
}

const goToPlusMember = () => {
  uni.navigateTo({ url: '/pages/vip/index' })
}

const goToCouponCenter = () => {
  uni.navigateTo({ url: '/pages/coupon/list' })
}

const goToCommunity = () => {
  uni.switchTab({ url: '/pages/community/index' })
}

const goToCrowdfunding = () => {
  uni.switchTab({ url: '/pages/crowdfunding/index' })
}

const goToContentDetail = (item: any) => {
  uni.navigateTo({ url: `/pages/community/detail?id=${item.id}` })
}

const goToProjectDetail = (project: any) => {
  uni.navigateTo({ url: `/pages/crowdfunding/detail?id=${project.id}` })
}

const handleSupportProject = (project: any) => {
  uni.navigateTo({ url: `/pages/crowdfunding/support?id=${project.id}` })
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // åŠ è½½é¡µé¢æ•°æ®
})
</script>

<style scoped lang="scss">
.home-page {
  background-color: #f5f5f5;
  min-height: 100vh;
}

.banner-swiper {
  height: 360rpx;

  .banner-image {
    width: 100%;
    height: 100%;
  }
}

.booking-section,
.marketing-section,
.recommend-section {
  margin: 30rpx;

  .section-title,
  .block-title {
    font-size: 32rpx;
    font-weight: bold;
    margin-bottom: 20rpx;
    color: #333;
  }
}

.marketing-card {
  margin-bottom: 20rpx;
}

.plus-benefits {
  .benefit-item {
    display: flex;
    align-items: center;
    margin-bottom: 10rpx;

    text {
      margin-left: 10rpx;
      font-size: 28rpx;
      color: #666;
    }
  }
}

.coupon-preview {
  .coupon-item {
    display: flex;
    align-items: center;
    margin-bottom: 10rpx;

    .coupon-desc {
      margin-left: 10rpx;
      font-size: 24rpx;
      color: #666;
    }
  }
}

.more-link {
  font-size: 24rpx;
  color: #007AFF;
  margin-left: auto;
}

.content-waterfall {
  display: flex;
  flex-wrap: wrap;
  gap: 10rpx;
}

.project-list {
  .project-card {
    margin-bottom: 20rpx;
  }
}
</style>
```

---

## 2. ä¸šåŠ¡ç»„ä»¶ç»„åˆç¤ºä¾‹

### 2.1 æˆ¿è½¦åˆ—è¡¨é¡µé¢ç¤ºä¾‹

```vue
<template>
  <view class="vehicle-list-page">
    <!-- ç­›é€‰å™¨ -->
    <view class="filter-section">
      <VehicleFilter
        :brands="brandOptions"
        :types="typeOptions"
        :price-range="[0, 2000]"
        :filters="currentFilters"
        @filter-change="handleFilterChange"
      />
    </view>

    <!-- è½¦è¾†åˆ—è¡¨ -->
    <view class="vehicle-section">
      <!-- éª¨æ¶å± -->
      <view v-if="loading" class="skeleton-container">
        <VehicleSkeleton
          v-for="i in 3"
          :key="`skeleton-${i}`"
          :rows="1"
          :animate="true"
          :height="200"
        />
      </view>

      <!-- å®é™…åˆ—è¡¨ -->
      <view v-else-if="vehicleList.length > 0" class="vehicle-list">
        <VehicleCard
          v-for="vehicle in vehicleList"
          :key="vehicle.id"
          :vehicle="vehicle"
          :show-store="true"
          :show-distance="true"
          :favorite="favoriteVehicles.has(vehicle.id)"
          @click="goToVehicleDetail"
          @favorite-change="handleFavoriteChange"
        />
      </view>

      <!-- ç©ºçŠ¶æ€ -->
      <view v-else class="empty-container">
        <uni-empty
          text="æš‚æ— ç¬¦åˆæ¡ä»¶çš„æˆ¿è½¦"
          description="è¯•è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶"
          :show-button="true"
          button-text="é‡ç½®ç­›é€‰"
          @button-click="resetFilters"
        />
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <uni-load-more
      :status="loadMoreStatus"
      @clickLoadMore="loadMoreVehicles"
    />
  </view>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'

// é¡µé¢å‚æ•°
const queryData = ref({
  city: '',
  store: '',
  pickupDate: '',
  returnDate: ''
})

// ç­›é€‰æ¡ä»¶
const brandOptions = ref([
  { id: 'benz', name: 'å¥”é©°', count: 23 },
  { id: 'ford', name: 'ç¦ç‰¹', count: 18 }
])

const typeOptions = ref([
  { id: 'A', name: 'Aå‹', count: 20 },
  { id: 'B', name: 'Bå‹', count: 25 }
])

const currentFilters = ref({
  brand: '',
  type: '',
  priceRange: [0, 2000],
  distance: 10
})

// åˆ—è¡¨æ•°æ®
const vehicleList = ref([])
const loading = ref(false)
const currentPage = ref(1)
const hasMore = ref(true)
const favoriteVehicles = ref(new Set())

// è®¡ç®—å±æ€§
const loadMoreStatus = computed(() => {
  if (loading.value) return 'loading'
  if (!hasMore.value) return 'noMore'
  return 'more'
})

// æ–¹æ³•
const handleFilterChange = (filters: any) => {
  currentFilters.value = { ...currentFilters.value, ...filters }
  currentPage.value = 1
  loadVehicles()
}

const loadVehicles = async () => {
  try {
    loading.value = true

    // æ„å»ºè¯·æ±‚å‚æ•°
    const params = {
      ...queryData.value,
      ...currentFilters.value,
      page: currentPage.value,
      limit: 10
    }

    // è°ƒç”¨API
    const response = await vehicleApi.getVehicleList(params)

    if (currentPage.value === 1) {
      vehicleList.value = response.data
    } else {
      vehicleList.value.push(...response.data)
    }

    hasMore.value = response.data.length >= 10
  } catch (error) {
    uni.showToast({
      title: 'åŠ è½½å¤±è´¥',
      icon: 'error'
    })
  } finally {
    loading.value = false
  }
}

const loadMoreVehicles = () => {
  if (hasMore.value && !loading.value) {
    currentPage.value++
    loadVehicles()
  }
}

const goToVehicleDetail = (vehicle: any) => {
  uni.navigateTo({
    url: `/pages/vehicles/detail?id=${vehicle.id}`
  })
}

const handleFavoriteChange = async (vehicle: any, isFavorite: boolean) => {
  try {
    if (isFavorite) {
      await favoriteApi.addFavorite(vehicle.id)
      favoriteVehicles.value.add(vehicle.id)
    } else {
      await favoriteApi.removeFavorite(vehicle.id)
      favoriteVehicles.value.delete(vehicle.id)
    }
  } catch (error) {
    uni.showToast({
      title: 'æ“ä½œå¤±è´¥',
      icon: 'error'
    })
  }
}

const resetFilters = () => {
  currentFilters.value = {
    brand: '',
    type: '',
    priceRange: [0, 2000],
    distance: 10
  }
  currentPage.value = 1
  loadVehicles()
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // è·å–é¡µé¢å‚æ•°
  const pages = getCurrentPages()
  const currentPage = pages[pages.length - 1]
  const { data } = currentPage.options

  if (data) {
    queryData.value = JSON.parse(decodeURIComponent(data))
  }

  loadVehicles()
})
</script>
```

---

## 3. åŸºç¡€ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹

### 3.1 è¡¨å•é¡µé¢ç¤ºä¾‹

```vue
<template>
  <view class="form-page">
    <uni-forms
      ref="formRef"
      :model-value="formData"
      :rules="formRules"
      label-width="80px"
      err-show-type="toast"
    >
      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <uni-card title="åŸºæœ¬ä¿¡æ¯" class="form-card">
        <uni-forms-item label="å§“å" name="name">
          <uni-easyinput
            v-model="formData.name"
            placeholder="è¯·è¾“å…¥çœŸå®å§“å"
            :clearable="true"
            maxlength="20"
          />
        </uni-forms-item>

        <uni-forms-item label="æ‰‹æœºå·" name="phone">
          <uni-easyinput
            v-model="formData.phone"
            placeholder="è¯·è¾“å…¥æ‰‹æœºå·"
            type="number"
            maxlength="11"
          />
        </uni-forms-item>

        <uni-forms-item label="èº«ä»½è¯" name="idCard">
          <uni-easyinput
            v-model="formData.idCard"
            placeholder="è¯·è¾“å…¥èº«ä»½è¯å·ç "
            maxlength="18"
          />
        </uni-forms-item>
      </uni-card>

      <!-- é©¾é©¶è¯ä¿¡æ¯ -->
      <uni-card title="é©¾é©¶è¯ä¿¡æ¯" class="form-card">
        <uni-forms-item label="è¯å·" name="licenseNumber">
          <uni-easyinput
            v-model="formData.licenseNumber"
            placeholder="è¯·è¾“å…¥é©¾é©¶è¯å·ç "
          />
        </uni-forms-item>

        <uni-forms-item label="å‡†é©¾è½¦å‹" name="licenseType">
          <uni-data-checkbox
            v-model="formData.licenseType"
            :localdata="licenseTypes"
            mode="list"
          />
        </uni-forms-item>

        <uni-forms-item label="æœ‰æ•ˆæœŸ" name="licenseExpiry">
          <uni-datetime-picker
            v-model="formData.licenseExpiry"
            type="date"
            placeholder="é€‰æ‹©é©¾é©¶è¯æœ‰æ•ˆæœŸ"
          />
        </uni-forms-item>

        <uni-forms-item label="è¯ä»¶ç…§ç‰‡" name="licenseImages">
          <view class="image-upload-section">
            <view class="upload-tip">
              è¯·ä¸Šä¼ é©¾é©¶è¯æ­£åé¢ç…§ç‰‡ï¼Œç¡®ä¿ä¿¡æ¯æ¸…æ™°å¯è§
            </view>
            <uni-file-picker
              v-model="formData.licenseImages"
              file-mediatype="image"
              :limit="2"
              mode="grid"
              @select="handleImageSelect"
              @delete="handleImageDelete"
            />
          </view>
        </uni-forms-item>
      </uni-card>
    </uni-forms>

    <!-- æäº¤æŒ‰é’® -->
    <view class="submit-section">
      <button
        type="primary"
        class="submit-button"
        :loading="submitting"
        @click="handleSubmit"
      >
        {{ submitting ? 'æäº¤ä¸­...' : 'æäº¤è®¤è¯' }}
      </button>
    </view>
  </view>
</template>

<script setup lang="ts">
import { ref, reactive } from 'vue'

// è¡¨å•æ•°æ®
const formData = reactive({
  name: '',
  phone: '',
  idCard: '',
  licenseNumber: '',
  licenseType: 'C1',
  licenseExpiry: '',
  licenseImages: []
})

// è¡¨å•éªŒè¯è§„åˆ™
const formRules = {
  name: {
    rules: [
      { required: true, errorMessage: 'è¯·è¾“å…¥å§“å' },
      { minLength: 2, maxLength: 20, errorMessage: 'å§“åé•¿åº¦åœ¨2-20ä¸ªå­—ç¬¦' }
    ]
  },
  phone: {
    rules: [
      { required: true, errorMessage: 'è¯·è¾“å…¥æ‰‹æœºå·' },
      { pattern: /^1[3-9]\d{9}$/, errorMessage: 'è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·' }
    ]
  },
  idCard: {
    rules: [
      { required: true, errorMessage: 'è¯·è¾“å…¥èº«ä»½è¯å·' },
      { pattern: /^\d{17}[\dX]$/, errorMessage: 'è¯·è¾“å…¥æ­£ç¡®çš„èº«ä»½è¯å·' }
    ]
  },
  licenseNumber: {
    rules: [
      { required: true, errorMessage: 'è¯·è¾“å…¥é©¾é©¶è¯å·' }
    ]
  },
  licenseExpiry: {
    rules: [
      { required: true, errorMessage: 'è¯·é€‰æ‹©æœ‰æ•ˆæœŸ' }
    ]
  }
}

const licenseTypes = ref([
  { value: 'C1', text: 'å°å‹æ±½è½¦' },
  { value: 'C2', text: 'å°å‹è‡ªåŠ¨æŒ¡æ±½è½¦' },
  { value: 'B1', text: 'ä¸­å‹å®¢è½¦' },
  { value: 'B2', text: 'å¤§å‹è´§è½¦' },
  { value: 'A1', text: 'å¤§å‹å®¢è½¦' },
  { value: 'A2', text: 'ç‰µå¼•è½¦' }
])

const formRef = ref()
const submitting = ref(false)

// æ–¹æ³•
const handleImageSelect = (event: any) => {
  console.log('é€‰æ‹©å›¾ç‰‡:', event.tempFiles)
}

const handleImageDelete = (event: any) => {
  console.log('åˆ é™¤å›¾ç‰‡:', event.tempFile)
}

const handleSubmit = async () => {
  try {
    // è¡¨å•éªŒè¯
    const valid = await formRef.value.validate()
    if (!valid) return

    submitting.value = true

    // æäº¤æ•°æ®
    const response = await authApi.submitVerification(formData)

    uni.showToast({
      title: 'æäº¤æˆåŠŸ',
      icon: 'success'
    })

    // è·³è½¬åˆ°è®¤è¯ç»“æœé¡µé¢
    setTimeout(() => {
      uni.redirectTo({
        url: '/pages/auth/result'
      })
    }, 1500)

  } catch (error) {
    console.error('æäº¤å¤±è´¥:', error)
    uni.showToast({
      title: 'æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•',
      icon: 'error'
    })
  } finally {
    submitting.value = false
  }
}
</script>

<style scoped lang="scss">
.form-page {
  padding: 30rpx;
  background-color: #f5f5f5;
  min-height: 100vh;
}

.form-card {
  margin-bottom: 30rpx;
}

.image-upload-section {
  .upload-tip {
    font-size: 24rpx;
    color: #666;
    margin-bottom: 20rpx;
  }
}

.submit-section {
  margin-top: 60rpx;
  padding: 0 30rpx;

  .submit-button {
    width: 100%;
    height: 88rpx;
    border-radius: 44rpx;
    font-size: 32rpx;
  }
}
</style>
```

---

## 4. å¸¸è§åœºæ™¯è§£å†³æ–¹æ¡ˆ

### 4.1 é•¿åˆ—è¡¨æ€§èƒ½ä¼˜åŒ–

```vue
<template>
  <view class="optimized-list">
    <!-- ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ä¼˜åŒ–é•¿åˆ—è¡¨ -->
    <recycle-scroller
      v-if="useVirtualScroll"
      class="scroller"
      :items="vehicleList"
      :item-size="200"
      key-field="id"
      v-slot="{ item }"
    >
      <VehicleCard
        :vehicle="item"
        :show-store="false"
        :show-distance="true"
        @click="goToDetail"
      />
    </recycle-scroller>

    <!-- æ™®é€šåˆ†é¡µåˆ—è¡¨ -->
    <view v-else class="paginated-list">
      <VehicleCard
        v-for="vehicle in displayList"
        :key="vehicle.id"
        :vehicle="vehicle"
        @click="goToDetail"
      />

      <!-- åŠ è½½æ›´å¤š -->
      <uni-load-more
        :status="loadMoreStatus"
        @clickLoadMore="loadMore"
      />
    </view>
  </view>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'

const vehicleList = ref([])
const useVirtualScroll = ref(false) // æ ¹æ®æ•°æ®é‡å†³å®šæ˜¯å¦ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
const currentPage = ref(1)
const pageSize = 20
const loading = ref(false)
const hasMore = ref(true)

// è®¡ç®—å±æ€§ - åªåœ¨éè™šæ‹Ÿæ»šåŠ¨æ—¶ä½¿ç”¨
const displayList = computed(() => {
  return vehicleList.value.slice(0, currentPage.value * pageSize)
})

const loadMoreStatus = computed(() => {
  if (loading.value) return 'loading'
  if (!hasMore.value) return 'noMore'
  return 'more'
})

// æ–¹æ³•
const loadVehicles = async () => {
  try {
    loading.value = true

    // æ‰¹é‡åŠ è½½ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°
    const response = await vehicleApi.getVehicleList({
      page: currentPage.value,
      limit: pageSize * 2 // æ¯æ¬¡åŠ è½½2é¡µæ•°æ®
    })

    const newVehicles = response.data

    if (useVirtualScroll.value) {
      // è™šæ‹Ÿæ»šåŠ¨æ¨¡å¼ï¼šç›´æ¥è¿½åŠ åˆ°åˆ—è¡¨
      vehicleList.value.push(...newVehicles)
    } else {
      // åˆ†é¡µæ¨¡å¼ï¼šæ›¿æ¢æ˜¾ç¤ºåˆ—è¡¨
      if (currentPage.value === 1) {
        vehicleList.value = newVehicles
      } else {
        vehicleList.value.push(...newVehicles)
      }
    }

    hasMore.value = newVehicles.length >= pageSize

    // æ ¹æ®æ•°æ®é‡è‡ªåŠ¨åˆ‡æ¢è™šæ‹Ÿæ»šåŠ¨
    if (vehicleList.value.length > 100 && !useVirtualScroll.value) {
      useVirtualScroll.value = true
    }

  } catch (error) {
    uni.showToast({
      title: 'åŠ è½½å¤±è´¥',
      icon: 'error'
    })
  } finally {
    loading.value = false
  }
}

const loadMore = () => {
  if (hasMore.value && !loading.value) {
    currentPage.value++
    loadVehicles()
  }
}
</script>

<style scoped lang="scss">
.scroller {
  height: calc(100vh - 200rpx);
}

.paginated-list {
  padding: 30rpx;
}
</style>
```

### 4.2 å›¾ç‰‡æ‡’åŠ è½½å’Œé”™è¯¯å¤„ç†

```vue
<template>
  <view class="optimized-images">
    <!-- å•†å“å›¾ç‰‡ç½‘æ ¼ -->
    <view class="image-grid">
      <view
        v-for="item in imageList"
        :key="item.id"
        class="image-item"
      >
        <!-- ä¼˜åŒ–åçš„å›¾ç‰‡ç»„ä»¶ -->
        <view class="image-container">
          <image
            :src="getOptimizedImageUrl(item.url)"
            :lazy-load="true"
            :fade-show="true"
            mode="aspectFill"
            class="item-image"
            @error="handleImageError(item)"
            @load="handleImageLoad(item)"
          />

          <!-- åŠ è½½çŠ¶æ€ -->
          <view v-if="item.loading" class="image-loading">
            <uni-load-more status="loading" icon-size="20" />
          </view>

          <!-- é”™è¯¯çŠ¶æ€ -->
          <view v-if="item.error" class="image-error">
            <uni-icons type="image" size="40" color="#ccc" />
            <text class="error-text">å›¾ç‰‡åŠ è½½å¤±è´¥</text>
          </view>
        </view>

        <text class="item-title">{{ item.title }}</text>
      </view>
    </view>
  </view>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue'

const imageList = ref([])

// å›¾ç‰‡URLä¼˜åŒ–
const getOptimizedImageUrl = (url: string) => {
  // æ ¹æ®è®¾å¤‡åƒç´ æ¯”é€‰æ‹©åˆé€‚çš„åˆ†è¾¨ç‡
  const dpr = uni.getSystemInfoSync().pixelRatio || 1
  const quality = dpr > 1 ? 'high' : 'medium'

  // æ·»åŠ WebPæ ¼å¼æ”¯æŒå’Œå‹ç¼©å‚æ•°
  if (url.includes('?')) {
    return `${url}&format=webp&quality=${quality}`
  } else {
    return `${url}?format=webp&quality=${quality}`
  }
}

// å›¾ç‰‡åŠ è½½æˆåŠŸå¤„ç†
const handleImageLoad = (item: any) => {
  item.loading = false
  item.error = false
}

// å›¾ç‰‡åŠ è½½å¤±è´¥å¤„ç†
const handleImageError = (item: any) => {
  item.loading = false
  item.error = true

  // ä½¿ç”¨é»˜è®¤å›¾ç‰‡
  item.url = '/static/default-image.png'

  console.warn('å›¾ç‰‡åŠ è½½å¤±è´¥:', item.originalUrl)
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  // é¢„åŠ è½½å…³é”®å›¾ç‰‡
  preloadImages()
})

const preloadImages = () => {
  const criticalImages = imageList.value.slice(0, 6)
  criticalImages.forEach(item => {
    uni.downloadFile({
      url: getOptimizedImageUrl(item.url),
      success: () => {
        item.preloaded = true
      }
    })
  })
}
</script>

<style scoped lang="scss">
.image-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20rpx;
  padding: 30rpx;
}

.image-item {
  .image-container {
    position: relative;
    width: 100%;
    height: 200rpx;
    border-radius: 12rpx;
    overflow: hidden;
    background-color: #f5f5f5;
  }

  .item-image {
    width: 100%;
    height: 100%;
    transition: transform 0.3s ease;
  }

  .image-loading {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .image-error {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;

    .error-text {
      display: block;
      font-size: 20rpx;
      color: #999;
      margin-top: 10rpx;
    }
  }

  .item-title {
    display: block;
    font-size: 28rpx;
    color: #333;
    margin-top: 16rpx;
    @include text-ellipsis(2);
  }
}
</style>
```

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- **[ç»„ä»¶æ€»è§ˆ](./ç»„ä»¶æ€»è§ˆ.md)** - ç»„ä»¶ä½“ç³»æ¦‚è§ˆ
- **[åŸºç¡€ç»„ä»¶æ–‡æ¡£](./åŸºç¡€ç»„ä»¶æ–‡æ¡£.md)** - åŸºç¡€ç»„ä»¶è¯¦ç»†è¯´æ˜
- **[ä¸šåŠ¡ç»„ä»¶æ–‡æ¡£](./ä¸šåŠ¡ç»„ä»¶æ–‡æ¡£.md)** - ä¸šåŠ¡ç»„ä»¶è¯¦ç»†è¯´æ˜
- **[ç»„ä»¶å¼€å‘è§„èŒƒ](../03-å¼€å‘æŒ‡å—/ç»„ä»¶å¼€å‘è§„èŒƒ.md)** - å¼€å‘æ ‡å‡†å’Œè§„èŒƒ
- **[æ€§èƒ½ä¼˜åŒ–æŒ‡å—](../03-å¼€å‘æŒ‡å—/æ€§èƒ½ä¼˜åŒ–æŒ‡å—.md)** - æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **æŒ‰éœ€å¼•å…¥**: åªå¼•å…¥éœ€è¦çš„ç»„ä»¶ï¼Œé¿å…æ‰“åŒ…ä½“ç§¯è¿‡å¤§
2. **é”™è¯¯å¤„ç†**: å§‹ç»ˆæ·»åŠ é”™è¯¯å¤„ç†å’ŒåŠ è½½çŠ¶æ€
3. **æ€§èƒ½ä¼˜åŒ–**: åˆç†ä½¿ç”¨æ‡’åŠ è½½ã€è™šæ‹Ÿæ»šåŠ¨ç­‰ä¼˜åŒ–æŠ€æœ¯
4. **ç”¨æˆ·ä½“éªŒ**: æ·»åŠ é€‚å½“çš„è¿‡æ¸¡åŠ¨ç”»å’Œäº¤äº’åé¦ˆ
5. **ä»£ç å¤ç”¨**: æå–é€šç”¨é€»è¾‘ä¸ºå¯å¤ç”¨çš„ç»„åˆå¼å‡½æ•°

---

**æ–‡æ¡£ç»´æŠ¤**: å¨å¨æˆ¿è½¦æŠ€æœ¯å›¢é˜Ÿ
**æœ€åæ›´æ–°**: 2025-11-24
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**ä¸‹æ¬¡å®¡æ ¸**: 2025-12-24