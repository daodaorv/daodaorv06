# 叨叨房车小程序组件开发规范

**文档版本**: v1.0.0 | **创建时间**: 2025-11-24 | **维护团队**: 叨叨房车技术团队

> 📖 **本文档专注于组件开发的标准规范和最佳实践**，具体组件的使用说明请参考：
> - [组件总览](../04-组件文档/组件总览.md) - 组件体系概览
> - [基础组件文档](../04-组件文档/基础组件文档.md) - 基础组件详细说明
> - [业务组件文档](../04-组件文档/业务组件文档.md) - 业务组件详细说明

---

## 📋 文档说明

本文档规定叨叨房车小程序组件开发的标准规范，包括开发流程、代码规范、性能要求、测试标准等。所有组件开发必须严格遵循本规范。

---

## 📋 目录

1. [开发流程规范](#1-开发流程规范)
2. [组件设计原则](#2-组件设计原则)
3. [代码编写规范](#3-代码编写规范)
4. [性能优化规范](#4-性能优化规范)
5. [测试质量规范](#5-测试质量规范)
6. [文档维护规范](#6-文档维护规范)
7. [审查检查清单](#7-审查检查清单)

---

## 1. 开发流程规范

### 1.1 组件开发流程

**步骤1：需求分析**
- 明确组件用途和应用场景
- 分析是否可以通过现有组件组合实现
- 确认开发必要性和优先级

**步骤2：技术方案设计**
- 设计组件接口（Props、Events、Slots）
- 制定组件实现方案
- 评估性能影响和兼容性

**步骤3：开发实现**
- 遵循代码规范进行开发
- 实现核心功能和边界处理
- 添加必要的日志和调试信息

**步骤4：测试验证**
- 编写单元测试用例
- 进行多平台兼容性测试
- 验证性能指���是否符合要求

**步骤5：文档编写**
- 编写组件使用文档
- 提供完整的使用示例
- 说明注意事项和最佳实践

**步骤6：代码审查**
- 提交代码审查申请
- 根据反馈进行修改完善
- 审查通过后合并代码

### 1.2 组件选择优先级

**🔥 第一优先级：uni-app内置组件**
- 性能最佳，原生支持
- 零维护成本，官方维护
- 适用所有基础功能场景

**⚡ 第二优先级：uni-ui组件库**
- 质量可靠，官方优化
- 维护成本低，定期更新
- 适用复杂UI组件场景

**🔶 第三优先级：自定义组件**
- 仅在前两者无法满足时使用
- 需要严格遵循开发规范
- 维护成本高，团队负责

### 1.3 组件复用检查清单

开发新组件前必须回答以下问题：

- [ ] uni-app内置组件是否无法满足需求？
- [ ] uni-ui组件库是否没有对应组件？
- [ ] 是否可以通过组合现有组件实现？
- [ ] 组件是否具有通用性和复用价值？
- [ ] 是否符合项目整体架构设计？

只有所有答案都是"是"时，才允许开发新组件。

---

## 2. 组件设计原则

### 2.1 单一职责原则
- 每个组件只负责一个特定功能
- 避免组件过于复杂，超过200行代码考虑拆分
- 保持组件的独立性和可测试性

### 2.2 开放封闭原则
- 对扩展开放，对修改封闭
- 通过Props和Slots提供扩展能力
- 避免直接修改组件内部实现

### 2.3 接口隔离原则
- 提供最小必要的Props接口
- 避免强迫用户使用不需要的功能
- 支持可选配置和默认值

### 2.4 依赖倒置原则
- 依赖抽象接口，不依赖具体实现
- 通过依赖注入提供灵活性
- 便于单元测试和模块替换

---

## 3. 代码编写规范

### 3.1 命名规范

**组件命名**:
- **文件名**: PascalCase（如 `VehicleCard.vue`）
- **组件名**: PascalCase（如 `<VehicleCard>`）
- **目录名**: kebab-case（如 `vehicle-card/`）

**Props命名**:
- 使用camelCase（如 `vehicleData`、`isLoading`）
- 布尔值Props以`is`、`has`、`can`开头（如 `isVisible`、`hasError`）
- 事件处理Props以`on`开头（如 `onSubmit`、`onCancel`）

**事件命名**:
- 使用kebab-case（如 `@item-click`、`@status-change`）
- 事件名应描述动作而非状态（如 `click` 而非 `clicked`）

**CSS类名**:
- 使用kebab-case（如 `vehicle-card`、`service-list`）
- 组件根元素使用组件同名类名
- 使用BEM命名法（如 `.vehicle-card__title`、`.vehicle-card--large`）

### 3.2 文件结构规范

**单文件组件结构**:
```vue
<template>
  <!-- 组件模板内容 -->
</template>

<script setup lang="ts">
// 1. 导入依赖
import { ref, computed, onMounted } from 'vue'
import type { ComponentProps } from './types'

// 2. Props定义
interface Props {
  title: string
  data?: any[]
  loading?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  data: () => [],
  loading: false
})

// 3. Events定义
const emit = defineEmits<{
  click: [id: string]
  change: [value: any]
}>()

// 4. 响应式数据
const count = ref(0)
const internalState = ref()

// 5. 计算属性
const processedData = computed(() => {
  return props.data.map(item => ({ ...item, processed: true }))
})

// 6. 方法定义
const handleClick = (id: string) => {
  emit('click', id)
}

// 7. 生命周期
onMounted(() => {
  // 初始化逻辑
})
</script>

<style scoped lang="scss">
// 组件样式
</style>
```

### 3.3 TypeScript规范

**类型定义**:
- 优先使用`interface`而非`type`
- 禁止使用`any`，使用`unknown`代替
- 为复杂对象类型创建单独的类型定义文件

**Props类型定义**:
```typescript
interface Props {
  // 基础类型
  title: string
  count: number
  visible: boolean

  // 可选属性
  description?: string

  // 数组类型
  items: Array<{
    id: string
    name: string
  }>

  // 联合类型
  size: 'small' | 'medium' | 'large'

  // 函数类型
  onClick?: (event: MouseEvent) => void
}
```

**Events类型定义**:
```typescript
const emit = defineEmits<{
  // 无参数事件
  close: []

  // 单参数事件
  'item-click': [id: string]

  // 多参数事件
  'form-submit': [formData: FormData, isValid: boolean]
}>()
```

### 2.3 代码规范

```typescript
// 组件Props定义
interface ComponentProps {
  modelValue?: string;          // v-model绑定值
  disabled?: boolean;           // 禁用状态
  loading?: boolean;            // 加载状态
  placeholder?: string;         // 占位提示
}

// 事件定义
const emit = defineEmits<{
  'update:modelValue': [value: string];
  'change': [value: any];
  'click': [event: MouseEvent];
}>();

// 样式规范
<style scoped lang="scss">
.component-name {
  // 使用CSS变量
  color: var(--text-primary);
  background: var(--bg-color);

  // 响应式设计
  @include mobile {
    padding: 20rpx;
  }
}
</style>
```

---

## 3. 基础组件

### 3.1 BaseButton - 统一按钮

#### 用途
提供统一的按钮样式和交互行为，支持多种类型和状态。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| type | 'primary' \| 'secondary' \| 'text' | 'primary' | 按钮类型 |
| size | 'small' \| 'medium' \| 'large' | 'medium' | 按钮尺寸 |
| disabled | boolean | false | 是否禁用 |
| loading | boolean | false | 是否加载中 |
| block | boolean | false | 是否块级按钮 |
| round | boolean | false | 是否圆角 |

#### 事件
| 事件名 | 参数 | 说明 |
|--------|------|------|
| click | (event: MouseEvent) | 点击事件 |

#### 使用示例
```vue
<template>
  <BaseButton
    type="primary"
    size="large"
    :loading="submitting"
    @click="handleSubmit"
  >
    立即预订
  </BaseButton>
</template>
```

### 3.2 BaseCard - 卡片容器

#### 用途
通用的卡片容器，用于信息展示和分组。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| padding | string \| number | '20rpx' | 内边距 |
| margin | string \| number | '0' | 外边距 |
| radius | string \| number | '12rpx' | 圆角大小 |
| shadow | boolean | true | 是否显示阴影 |
| border | boolean | false | 是否显示边框 |

#### Slots
| 插槽名 | 说明 |
|--------|------|
| default | 卡片内容 |
| header | 卡片头部 |
| footer | 卡片底部 |

#### 使用示例
```vue
<template>
  <BaseCard padding="30rpx" shadow>
    <template #header>
      <text>卡片标题</text>
    </template>
    <view>卡片内容</view>
  </BaseCard>
</template>
```

### 3.3 BaseEmpty - 空状态提示

#### 用途
用于无数据状态的统一提示。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| image | string | 'default' | 空状态图片 |
| text | string | '暂无数据' | 提示文字 |
| description | string | '' | 详细描述 |
| showButton | boolean | false | 是否显示操作按钮 |
| buttonText | string | '去操作' | 按钮文字 |

#### 事件
| 事件名 | 参数 | 说明 |
|--------|------|------|
| button-click | () | 按钮点击事件 |

#### 使用示例
```vue
<template>
  <BaseEmpty
    text="暂无订单"
    description="您还没有相关订单"
    :show-button="true"
    button-text="去预订"
    @button-click="goToBooking"
  />
</template>
```

### 3.4 BaseLoading - 加载状态

#### 用途
统一的加载状态组件。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| type | 'spinner' \| 'dots' \| 'pulse' | 'spinner' | 加载类型 |
| size | string \| number | '40rpx' | 加载图标大小 |
| color | string | '#FF9F29' | 加载颜色 |
| text | string | '' | 加载文字 |

### 3.5 BasePopup - 弹窗容器

#### 用途
统一的弹窗容器组件。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| show | boolean | false | 是否显示弹窗 |
| position | 'center' \| 'bottom' \| 'top' | 'center' | 弹窗位置 |
| closable | boolean | true | 是否可关闭 |
| maskClosable | boolean | true | 点击遮罩是否关闭 |

#### 事件
| 事件名 | 参数 | 说明 |
|--------|------|------|
| close | () | 弹窗关闭事件 |

### 3.6 BaseDivider - 分割线

#### 用途
内容分割的视觉元素。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| height | string \| number | '1rpx' | 分割线高度 |
| color | string | '#E5E5E5' | 分割线颜色 |
| margin | string \| number | '20rpx 0' | 上下边距 |
| dashed | boolean | false | 是否虚线 |

### 3.7 BaseTag - 标签组件

#### 用途
用于状态标记、分类显示等场景。

#### Props
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| text | string | '' | 标签文字 |
| type | 'primary' \| 'success' \| 'warning' \| 'error' | 'primary' | 标签类型 |
| size | 'small' \| 'medium' \| 'large' | 'medium' | 标签尺寸 |
| closable | boolean | false | 是否可关闭 |

---

## 4. 业务组件

### 4.1 房车相关组件

#### 4.1.1 VehicleCard - 房车卡片

**用途**: 房车列表和详情页面的信息展示卡片。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| vehicle | Vehicle | - | 房车信息对象 |
| showStore | boolean | true | 是否显示门店信息 |
| showDistance | boolean | true | 是否显示距离 |
| favorite | boolean | false | 是否已收藏 |

**事件**:
| 事件名 | 参数 | 说明 |
|--------|------|------|
| click | (vehicle: Vehicle) | 点击卡片 |
| favorite-change | (vehicle: Vehicle, isFavorite: boolean) | 收藏状态改变 |

**使用示例**:
```vue
<template>
  <VehicleCard
    :vehicle="vehicle"
    :favorite="isFavorite"
    @click="goToDetail"
    @favorite-change="handleFavorite"
  />
</template>
```

#### 4.1.2 VehicleFilter - 车辆筛选器

**用途**: 房车列表页面的筛选条件选择。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| brands | BrandOption[] | [] | 品牌选项 |
| types | VehicleType[] | [] | 车型选项 |
| priceRange | [number, number] | [0, 5000] | 价格范围 |
| filters | FilterOptions | - | 当前筛选条件 |

**事件**:
| 事件名 | 参数 | 说明 |
|--------|------|------|
| filter-change | (filters: FilterOptions) | 筛选条件改变 |

#### 4.1.3 VehicleBooking - 预订表单

**用途**: 首页和预订页面的预订信息填写表单。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| bookingData | BookingData | - | 预订数据 |
| stores | Store[] | [] | 门店列表 |
| showReturnStore | boolean | false | 是否显示还车门店 |

#### 4.1.4 InsuranceSelector - 保险选择器

**用途**: 订单确认页面的保险方案选择。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| options | InsuranceOption[] | [] | 保险选项 |
| selected | string | '' | 已选保险ID |

#### 4.1.5 ServiceAddon - 附加服务

**用途**: 订单确认页面的附加服务选择。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| services | ServiceOption[] | [] | 服务列表 |
| selected | string[] | [] | 已选服务ID列表 |

### 4.2 订单相关组件

#### 4.2.1 OrderSummary - 订单汇总

**用途**: 订单确认和支付页面的费用明细展示。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| order | OrderData | - | 订单数据 |
| showCoupon | boolean | true | 是否显示优惠券 |

#### 4.2.2 OrderStatus - 订单状态

**用途**: 订单列表和详情页面的状态展示。

#### 4.2.3 PaymentMethod - 支付方式

**用途**: 支付页面的支付方式选择。

### 4.3 众筹相关组件

#### 4.3.1 ProjectCard - 众筹项目卡片

**用途**: 众筹项目列表和详情展示。

**Props**:
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| project | Project | - | 项目信息 |
| showProgress | boolean | true | 是否显示进度条 |

#### 4.3.2 TradingPanel - 交易面板

**用途**: 份额交易市场的买卖操作面板。

#### 4.3.3 ShareholdingCard - 持仓卡片

**用途**: 个人持仓信息展示。

#### 4.3.4 OrderBookCard - 委托单卡片

**用途**: 交易委托单信息展示。

---

## 5. 营销推广组件

### 5.1 CouponCard - 优惠券卡片

### 5.2 MemberBanner - 会员推广横幅

### 5.3 PromotionBanner - 活动推广横幅

### 5.4 RecommendationList - 推荐内容列表

### 5.5 QuickEntryGrid - 快捷入口网格

---

## 6. 表单组件

### 6.1 CitySelector - 城市选择器

### 6.2 StoreSelector - 门店选择器

### 6.3 DateTimePicker - 日期时间选择器

### 6.4 ContactForm - 联系人表单

### 6.5 LicenseUpload - 证件上传

---

## 7. 内容组件

### 7.1 ContentCard - 内容卡片

### 7.2 UserAvatar - 用户头像

### 7.3 InteractionBar - 互动栏

### 7.4 ImageGallery - 图片画廊

---

## 8. 组件使用指南

### 8.1 在页面中使用组件

```vue
<template>
  <view class="page">
    <!-- 基础组件 -->
    <BaseCard>
      <VehicleCard
        :vehicle="vehicle"
        @click="handleVehicleClick"
      />
    </BaseCard>

    <!-- 业务组件 -->
    <VehicleBooking
      :booking-data="bookingData"
      @booking-change="handleBookingChange"
    />
  </view>
</template>

<script setup>
import { VehicleCard, VehicleBooking } from '@/components/business/vehicle'
import { BaseCard } from '@/components/base'
</script>
```

### 8.2 组件全局注册

```typescript
// main.ts
import { createSSRApp } from 'vue'
import App from './App.vue'

// 自动注册组件
const components = import.meta.glob('./components/**/*.vue', { eager: true })

export function createApp() {
  const app = createSSRApp(App)

  // 全局注册组件
  Object.entries(components).forEach(([path, component]: [string, any]) => {
    const name = path.split('/').pop()?.replace('.vue', '') || ''
    app.component(name, component.default)
  })

  return {
    app
  }
}
```

---

## 9. 性能优化建议

### 9.1 组件懒加载

```typescript
// 大型组件使用动态导入
const HeavyComponent = defineAsyncComponent(() => import('./HeavyComponent.vue'))
```

### 9.2 虚拟列表

```vue
<!-- 长列表使用虚拟滚动 -->
<recycle-scroller
  class="scroller"
  :items="largeList"
  :item-size="100"
  key-field="id"
>
  <template #default="{ item }">
    <VehicleCard :vehicle="item" />
  </template>
</recycle-scroller>
```

### 9.3 图片优化

```vue
<!-- 图片懒加载和webp格式支持 -->
<image
  :src="`${imageUrl}?format=webp`"
  mode="aspectFill"
  lazy-load
  @error="handleImageError"
/>
```

---

## 文档维护说明

本文档将随着组件的迭代更新而持续维护。所有组件变更都应同步更新到此文档，确保文档的准确性和时效性。

**维护者**: 叨叨房车技术团队
**最后更新**: 2025-11-22
**下次审核**: 2025-12-22