# å¨å¨æˆ¿è½¦ - ç§»åŠ¨ç®¡ç†ç«¯

## ğŸ“± é¡¹ç›®ç®€ä»‹

ç§»åŠ¨ç®¡ç†ç«¯æ˜¯åŸºäº uni-app å¼€å‘çš„ç§»åŠ¨ç«¯ç®¡ç†åº”ç”¨ï¼Œä¾›ç®¡ç†å‘˜åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šè¿›è¡Œç”¨æˆ·ç®¡ç†ã€è®¢å•ç®¡ç†ç­‰æ“ä½œã€‚

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
mobile-admin/
â”œâ”€â”€ api/                    # APIæ¥å£æ¨¡å—
â”‚   â”œâ”€â”€ auth.js            # è®¤è¯ç›¸å…³API
â”‚   â”œâ”€â”€ user.js            # ç”¨æˆ·ç®¡ç†API
â”‚   â””â”€â”€ index.js           # APIç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ index.js           # åº”ç”¨é…ç½®ï¼ˆAPIåœ°å€ç­‰ï¼‰
â”œâ”€â”€ pages/                  # é¡µé¢æ–‡ä»¶
â”‚   â”œâ”€â”€ index/             # é¦–é¡µ
â”‚   â”œâ”€â”€ login/             # ç™»å½•é¡µ
â”‚   â””â”€â”€ users/             # ç”¨æˆ·ç®¡ç†é¡µ
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ request.js         # ç»Ÿä¸€è¯·æ±‚å°è£…
â”œâ”€â”€ App.vue                 # åº”ç”¨å…¥å£
â”œâ”€â”€ main.js                 # ä¸»å…¥å£æ–‡ä»¶
â”œâ”€â”€ pages.json             # é¡µé¢é…ç½®
â””â”€â”€ manifest.json          # åº”ç”¨é…ç½®
```

## ğŸ”§ æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: uni-app (Vue 3)
- **UI**: åŸç”Ÿç»„ä»¶
- **çŠ¶æ€ç®¡ç†**: æœ¬åœ°å­˜å‚¨ (localStorage)
- **HTTPå®¢æˆ·ç«¯**: uni.request (å°è£…)

## ğŸ“ ä»£ç è§„èŒƒ

### 1. APIè°ƒç”¨è§„èŒƒ

**âœ… æ­£ç¡®åšæ³•**:
```javascript
import { authApi } from '../../api/auth'

// ä½¿ç”¨APIæ¨¡å—
const result = await authApi.login({
  phone: phone.value,
  password: password.value
})
```

**âŒ é”™è¯¯åšæ³•**:
```javascript
// ä¸è¦ç›´æ¥ä½¿ç”¨ uni.request ç¡¬ç¼–ç 
const res = await uni.request({
  url: 'http://localhost:3000/api/auth/login',
  method: 'POST',
  data: { ... }
})
```

### 2. æœ¬åœ°å­˜å‚¨è§„èŒƒ

ç§»åŠ¨ç®¡ç†ç«¯ä½¿ç”¨ `mobile_admin_` å‰ç¼€ï¼Œé¿å…ä¸å°ç¨‹åºç«¯å†²çªï¼š

```javascript
// âœ… æ­£ç¡®
uni.setStorageSync('mobile_admin_token', token)
uni.getStorageSync('mobile_admin_token')

// âŒ é”™è¯¯
uni.setStorageSync('token', token)  // å¯èƒ½ä¸å°ç¨‹åºç«¯å†²çª
```

### 3. é”™è¯¯å¤„ç†è§„èŒƒ

ç»Ÿä¸€ä½¿ç”¨ try-catch å¤„ç†é”™è¯¯ï¼š

```javascript
try {
  const result = await authApi.login(data)
  // å¤„ç†æˆåŠŸé€»è¾‘
} catch (error) {
  console.error('ç™»å½•å¤±è´¥:', error)
  uni.showToast({ 
    title: error.message || 'ç™»å½•å¤±è´¥', 
    icon: 'none' 
  })
}
```

## ğŸš€ å¼€å‘æŒ‡å—

### å¯åŠ¨é¡¹ç›®

1. ä½¿ç”¨ HBuilderX æ‰“å¼€é¡¹ç›®
2. é€‰æ‹©è¿è¡Œåˆ°æµè§ˆå™¨æˆ–æ‰‹æœºæ¨¡æ‹Ÿå™¨
3. ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨ (http://localhost:3000)

### æ·»åŠ æ–°çš„API

1. åœ¨ `api/` ç›®å½•ä¸‹åˆ›å»ºå¯¹åº”çš„æ¨¡å—æ–‡ä»¶
2. ä½¿ç”¨ `request` å·¥å…·è¿›è¡Œå°è£…
3. åœ¨ `api/index.js` ä¸­å¯¼å‡º

ç¤ºä¾‹ï¼š
```javascript
// api/order.js
import request from '../utils/request';

export const orderApi = {
  getOrderList(params) {
    return request.get('/orders', params);
  }
};
```

### æ·»åŠ æ–°é¡µé¢

1. åœ¨ `pages/` ç›®å½•ä¸‹åˆ›å»ºé¡µé¢æ–‡ä»¶å¤¹
2. åœ¨ `pages.json` ä¸­æ³¨å†Œé¡µé¢
3. ä½¿ç”¨APIæ¨¡å—è¿›è¡Œæ•°æ®è¯·æ±‚

## ğŸ” è®¤è¯æµç¨‹

1. ç”¨æˆ·åœ¨ç™»å½•é¡µè¾“å…¥æ‰‹æœºå·å’Œå¯†ç 
2. è°ƒç”¨ `authApi.login()` è¿›è¡Œç™»å½•
3. ç™»å½•æˆåŠŸåä¿å­˜ token å’Œç”¨æˆ·ä¿¡æ¯åˆ°æœ¬åœ°å­˜å‚¨
4. åç»­è¯·æ±‚è‡ªåŠ¨åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ token
5. token è¿‡æœŸæ—¶è‡ªåŠ¨è·³è½¬åˆ°ç™»å½•é¡µ

## ğŸ“¦ APIæ¨¡å—è¯´æ˜

### authApi (è®¤è¯)

- `login(data)`: ç®¡ç†å‘˜ç™»å½•
- `logout()`: é€€å‡ºç™»å½•
- `getCurrentUser()`: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

### userApi (ç”¨æˆ·ç®¡ç†)

- `getUserList(params)`: è·å–ç”¨æˆ·åˆ—è¡¨
- `getUserDetail(userId)`: è·å–ç”¨æˆ·è¯¦æƒ…
- `updateUser(userId, data)`: æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- `updateUserStatus(userId, status)`: æ›´æ–°ç”¨æˆ·çŠ¶æ€
- `deleteUser(userId)`: åˆ é™¤ç”¨æˆ·

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç™»å½•åè·³è½¬å¤±è´¥

æ£€æŸ¥ `pages.json` ä¸­çš„ tabBar é…ç½®ï¼Œç¡®ä¿é¦–é¡µè·¯å¾„æ­£ç¡®ã€‚

### 2. APIè¯·æ±‚å¤±è´¥

- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
- æ£€æŸ¥ `config/index.js` ä¸­çš„ baseURL é…ç½®
- æ£€æŸ¥ç½‘ç»œè¿æ¥

### 3. token è¿‡æœŸ

ç³»ç»Ÿä¼šè‡ªåŠ¨å¤„ç† 401 é”™è¯¯ï¼Œæ¸…é™¤æœ¬åœ° token å¹¶è·³è½¬åˆ°ç™»å½•é¡µã€‚

## ğŸ“„ æ›´æ–°æ—¥å¿—

### 2025-11-19

**é‡å¤§é‡æ„**:
- âœ… åˆ›å»ºäº†ç‹¬ç«‹çš„ API æ¨¡å— (`api/auth.js`, `api/user.js`)
- âœ… åˆ›å»ºäº†ç»Ÿä¸€çš„è¯·æ±‚å°è£… (`utils/request.js`)
- âœ… åˆ›å»ºäº†é…ç½®æ–‡ä»¶ (`config/index.js`)
- âœ… é‡æ„äº†æ‰€æœ‰é¡µé¢ï¼Œç§»é™¤ç¡¬ç¼–ç çš„ API è¯·æ±‚
- âœ… ç»Ÿä¸€äº†æœ¬åœ°å­˜å‚¨é”®åï¼ˆä½¿ç”¨ `mobile_admin_` å‰ç¼€ï¼‰
- âœ… æ”¹è¿›äº†é”™è¯¯å¤„ç†å’Œç”¨æˆ·ä½“éªŒ

**ä¿®å¤çš„é—®é¢˜**:
- ğŸ› ä¿®å¤äº†ç¡¬ç¼–ç  API URL çš„é—®é¢˜
- ğŸ› ä¿®å¤äº†ä¸å°ç¨‹åºç«¯ token å†²çªçš„é—®é¢˜
- ğŸ› ä¿®å¤äº†ç¼ºå°‘ç»Ÿä¸€é”™è¯¯å¤„ç†çš„é—®é¢˜
- ğŸ› ä¿®å¤äº†ä»£ç é‡å¤åº¦é«˜çš„é—®é¢˜

## ğŸ‘¥ å¼€å‘å›¢é˜Ÿ

å¨å¨æˆ¿è½¦å¼€å‘å›¢é˜Ÿ

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

