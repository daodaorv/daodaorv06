# ç®¡ç†ç«¯ï¼ˆAdmin Consoleï¼‰æµ‹è¯•ç»“æœ

## ğŸ“… æµ‹è¯•æ—¶é—´
2025-11-19 11:24 (æ›´æ–°)

## âœ… ä¿®å¤çš„é—®é¢˜

### 0. å“åº”çŠ¶æ€ç åˆ¤æ–­é”™è¯¯ âš ï¸ **æœ€æ–°ä¿®å¤**
**é—®é¢˜**: ç™»å½•æˆåŠŸä½†è¢«å½“ä½œé”™è¯¯å¤„ç†
```
ç™»å½•å¤±è´¥: Error: Login successful
```

**åŸå› **: åç«¯è¿”å› `code: 0` è¡¨ç¤ºæˆåŠŸï¼Œä½†å‰ç«¯åˆ¤æ–­ `code !== 200`

**ä¿®å¤**: æ›´æ–° `admin-console/src/api/request.ts`
```typescript
// âŒ é”™è¯¯çš„åˆ¤æ–­
if (res.code !== undefined && res.code !== 200) {

// âœ… æ­£ç¡®çš„åˆ¤æ–­ï¼ˆåç«¯ code: 0 è¡¨ç¤ºæˆåŠŸï¼‰
if (res.code !== undefined && res.code !== 0) {
```

### 1. CORS è·¨åŸŸé”™è¯¯ âš ï¸ **å·²ä¿®å¤**
**é—®é¢˜**: å‰ç«¯æ— æ³•è®¿é—®åç«¯ API
```
Access to XMLHttpRequest has been blocked by CORS policy:
No 'Access-Control-Allow-Origin' header is present
```

**åŸå› **: åç«¯ CORS é…ç½®åªå…è®¸ `localhost:5173`ï¼Œä½†ç®¡ç†ç«¯è¿è¡Œåœ¨ `localhost:5174`

**ä¿®å¤**: æ›´æ–° `backend/src/index.ts`
```typescript
app.use(cors({
  origin: process.env.NODE_ENV === 'production'
    ? ['https://admin.daodaorv.com', 'https://m.daodaorv.com']
    : ['http://localhost:5173', 'http://localhost:5174', 'http://localhost:3000'],
  credentials: true,
  methods: ['GET', 'POST', 'PUT', 'DELETE', 'PATCH', 'OPTIONS'],
  allowedHeaders: ['Content-Type', 'Authorization']
}));
```

### 1. Axios å¯¼å…¥é”™è¯¯ âš ï¸ **é‡è¦ä¿®å¤**
**é—®é¢˜**: `AxiosInstance` ç­‰ç±»å‹ä½œä¸ºå€¼å¯¼å…¥å¯¼è‡´è¿è¡Œæ—¶é”™è¯¯
```
SyntaxError: The requested module does not provide an export named 'AxiosInstance'
```

**ä¿®å¤**:
```typescript
// é”™è¯¯çš„å¯¼å…¥æ–¹å¼
import axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios'

// æ­£ç¡®çš„å¯¼å…¥æ–¹å¼
import axios from 'axios'
import type { AxiosInstance, AxiosRequestConfig, AxiosResponse } from 'axios'
```

### 1. API å‚æ•°ä¸åŒ¹é…
**é—®é¢˜**: å‰ç«¯ä½¿ç”¨çš„å‚æ•°åä¸åç«¯ä¸ä¸€è‡´
- å‰ç«¯: `page_size`, `keyword`
- åç«¯: `pageSize`, `search`

**ä¿®å¤**: 
- æ›´æ–° `src/api/user.ts` ä¸­çš„æ¥å£å®šä¹‰
- æ›´æ–° `src/views/users/index.vue` ä¸­çš„å‚æ•°ä¼ é€’

### 2. æ•°æ®ç»“æ„ä¸åŒ¹é…
**é—®é¢˜**: å‰ç«¯æœŸæœ›çš„ç”¨æˆ·æ•°æ®ç»“æ„ä¸åç«¯è¿”å›ä¸ä¸€è‡´
- åç«¯è¿”å›: `users`, `user_type`, `username`
- å‰ç«¯æœŸæœ›: `list`, `role`, `nickname`

**ä¿®å¤**:
- æ›´æ–° User æ¥å£å®šä¹‰ä»¥åŒ¹é…åç«¯æ•°æ®ç»“æ„
- æ›´æ–°æ‰€æœ‰è§†å›¾ç»„ä»¶ä»¥ä½¿ç”¨æ­£ç¡®çš„å­—æ®µå

### 3. Token å­˜å‚¨é”®åä¸ä¸€è‡´
**é—®é¢˜**: è·¯ç”±å®ˆå«ä½¿ç”¨ `token`ï¼Œç™»å½•é¡µé¢ä½¿ç”¨ `admin_token`

**ä¿®å¤**:
- ç»Ÿä¸€ä½¿ç”¨ `admin_token` ä½œä¸ºå­˜å‚¨é”®å

### 4. ç™»å½• API ç¼ºå°‘ platform å‚æ•°
**é—®é¢˜**: ç™»å½•æ—¶æœªä¼ é€’ `platform` å‚æ•°

**ä¿®å¤**:
- åœ¨ç™»å½•è¯·æ±‚ä¸­æ·»åŠ  `platform: 'pc-admin'`

### 5. ç”¨æˆ·çŠ¶æ€å€¼ä¸åŒ¹é…
**é—®é¢˜**: å‰ç«¯ä½¿ç”¨ `disabled`ï¼Œåç«¯ä½¿ç”¨ `inactive`

**ä¿®å¤**:
- æ›´æ–°æ‰€æœ‰ç»„ä»¶ä½¿ç”¨åç«¯çš„çŠ¶æ€å€¼: `active`, `inactive`, `banned`

## ğŸ§ª æµ‹è¯•ç»“æœ

### API æµ‹è¯•

#### 1. ç™»å½• API âœ…
```bash
POST /api/v1/auth/login
Body: {
  "phone": "13800138000",
  "password": "123456",
  "login_type": "password",
  "platform": "pc-admin"
}
```
**ç»“æœ**: æˆåŠŸè¿”å› token å’Œç”¨æˆ·ä¿¡æ¯

#### 2. ç”¨æˆ·åˆ—è¡¨ API âœ…
```bash
GET /api/v1/users?page=1&pageSize=10
Headers: Authorization: Bearer {token}
```
**ç»“æœ**: æˆåŠŸè¿”å›ç”¨æˆ·åˆ—è¡¨
- æ€»æ•°: 2
- ç”¨æˆ·1: admin (pc_admin)
- ç”¨æˆ·2: test_user (customer)

### å‰ç«¯æµ‹è¯•

#### 1. å¼€å‘æœåŠ¡å™¨ âœ…
- å¯åŠ¨æˆåŠŸ
- è¿è¡Œåœ¨: http://localhost:5174/
- Vite ç‰ˆæœ¬: 4.5.14

#### 2. é¡µé¢è·¯ç”± âœ…
- `/` - é¦–é¡µ
- `/login` - ç™»å½•é¡µ
- `/dashboard` - ä»ªè¡¨ç›˜
- `/users` - ç”¨æˆ·åˆ—è¡¨
- `/users/:id` - ç”¨æˆ·è¯¦æƒ…
- `/users/:id/edit` - ç¼–è¾‘ç”¨æˆ·

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

1. `src/api/auth.ts` - æ·»åŠ  platform å‚æ•°
2. `src/api/user.ts` - æ›´æ–°æ¥å£å®šä¹‰å’Œæ•°æ®ç»“æ„
3. `src/router/index.ts` - ä¿®å¤ token é”®å
4. `src/views/Login.vue` - æ·»åŠ  platform å‚æ•°
5. `src/views/users/index.vue` - æ›´æ–°å‚æ•°å’Œå­—æ®µå
6. `src/views/users/Detail.vue` - æ›´æ–°æ•°æ®å­—æ®µ
7. `src/views/users/Edit.vue` - æ›´æ–°è¡¨å•å­—æ®µ

## ğŸ¯ åŠŸèƒ½éªŒè¯

### âœ… å·²éªŒè¯åŠŸèƒ½
- [x] ç”¨æˆ·ç™»å½•
- [x] Token è®¤è¯
- [x] ç”¨æˆ·åˆ—è¡¨è·å–
- [x] åˆ†é¡µåŠŸèƒ½
- [x] è·¯ç”±å®ˆå«
- [x] API è¯·æ±‚æ‹¦æˆªå™¨
- [x] å“åº”æ‹¦æˆªå™¨
- [x] é”™è¯¯å¤„ç†

### ğŸ”„ å¾…æµ‹è¯•åŠŸèƒ½
- [ ] ç”¨æˆ·è¯¦æƒ…æŸ¥çœ‹
- [ ] ç”¨æˆ·ä¿¡æ¯ç¼–è¾‘
- [ ] ç”¨æˆ·çŠ¶æ€åˆ‡æ¢
- [ ] ç”¨æˆ·åˆ é™¤
- [ ] æ‰¹é‡åˆ é™¤
- [ ] æœç´¢è¿‡æ»¤
- [ ] å¯†ç é‡ç½®

## ğŸš€ ä¸‹ä¸€æ­¥

1. åœ¨æµè§ˆå™¨ä¸­å®Œæ•´æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
2. æµ‹è¯•ç”¨æˆ·ç¼–è¾‘å’Œåˆ é™¤åŠŸèƒ½
3. æµ‹è¯•æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½
4. æµ‹è¯•æƒé™æ§åˆ¶
5. ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. æ‰€æœ‰ localStorage é”®åä½¿ç”¨ `admin_` å‰ç¼€ï¼Œé¿å…ä¸ç§»åŠ¨ç«¯å†²çª
2. API å‚æ•°åéµå¾ªåç«¯è§„èŒƒï¼ˆé©¼å³°å‘½åï¼‰
3. ç”¨æˆ·ç±»å‹: `customer`, `mobile_admin`, `pc_admin`
4. ç”¨æˆ·çŠ¶æ€: `active`, `inactive`, `banned`
5. **TypeScript ç±»å‹å¯¼å…¥å¿…é¡»ä½¿ç”¨ `type` å…³é”®å­—**

## ğŸ§ª æµ‹è¯•å·¥å…·

å·²åˆ›å»ºæµ‹è¯•é¡µé¢: `æµ‹è¯•ç™»å½•.html`
- å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æµ‹è¯•ç™»å½•åŠŸèƒ½
- éªŒè¯åç«¯ API æ˜¯å¦æ­£å¸¸å·¥ä½œ
- æŸ¥çœ‹ç™»å½•å“åº”æ•°æ®

## ğŸ”§ å¦‚ä½•ä½¿ç”¨

1. ç¡®ä¿åç«¯æœåŠ¡è¿è¡Œ: `cd backend && npm run dev`
2. å¯åŠ¨ç®¡ç†ç«¯: `cd admin-console && npm run dev`
3. è®¿é—®: http://localhost:5174/
4. ä½¿ç”¨æµ‹è¯•è´¦å·ç™»å½•:
   - æ‰‹æœºå·: 13800138000
   - å¯†ç : 123456
