# 叨叨房车API接口文档

## 概览

本文档描述叨叨房车系统的RESTful API接口，供前端开发者使用。

## 基础信息

- **基础URL**: `http://localhost:3001` (开发环境Mock服务)
- **生产URL**: `https://api.daodao.com` (生产环境)
- **API版本**: v1
- **数据格式**: JSON
- **字符编码**: UTF-8

## 认证方式

### JWT Token认证
所有需要认证的接口都需要在请求头中包含JWT Token：

```http
Authorization: Bearer <your-jwt-token>
```

### Token获取
通过登录接口获取Token，Token有效期为15分钟，refreshToken有效期为7天。

## 通用响应格式

### 成功响应
```json
{
  "code": 0,
  "message": "success",
  "data": {
    // 具体数据内容
  },
  "meta": {
    "timestamp": "2025-11-24T10:00:00+08:00",
    "requestId": "req_123456789"
  }
}
```

### 错误响应
```json
{
  "code": 400001,
  "message": "请求参数错误",
  "data": {},
  "meta": {
    "timestamp": "2025-11-24T10:00:00+08:00",
    "requestId": "req_123456789"
  }
}
```

### 分页响应
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "list": [
      // 数据列表
    ],
    "pagination": {
      "page": 1,
      "limit": 10,
      "total": 100,
      "pages": 10
    }
  },
  "meta": {
    "timestamp": "2025-11-24T10:00:00+08:00",
    "requestId": "req_123456789"
  }
}
```

## 错误码体系

### 通用错误码 (100000-199999)
- `100000`: 系统错误
- `100001`: 参数错误
- `100002`: 接口不存在
- `100003`: 请求方法不允许
- `100004`: 请求频率过高

### 认证相关错误码 (200000-299999)
- `200001`: 未登录
- `200002`: Token已过期
- `200003`: Token无效
- `200004`: 用户不存在
- `200005`: 密码错误
- `200006`: 手机验证码错误
- `200007`: 账号被禁用

### 用户相关错误码 (210000-219999)
- `210001`: 用户信息不存在
- `210002`: 手机号已注册
- `210003`: 用户信息不完整

### 车辆相关错误码 (500000-599999)
- `500001`: 车辆不存在
- `500002`: 车辆不可用
- `500003`: 车辆已被预订
- `500004`: 车辆信息不完整

### 订单相关错误码 (300000-399999)
- `300001`: 订单不存在
- `300002`: 订单状态不允许此操作
- `300003`: 订单已取消
- `300004`: 订单已支付

### 支付相关错误码 (400000-499999)
- `400001`: 支付失败
- `400002`: 余额不足
- `400003`: 支付方式不支持
- `400004`: 退款失败

## 请求头要求

### 必需的请求头
```http
Content-Type: application/json
User-Agent: DaodaoApp/1.0.0
```

### 可选的请求头
```http
X-Client-Version: 1.0.0
X-Platform: miniprogram | web | mobile
X-Device-ID: your-device-id
```

## 请求参数

### 查询参数
- `page`: 页码，从1开始，默认1
- `limit`: 每页数量，默认10，最大100
- `sort`: 排序字段
- `order`: 排序方向，asc|desc

### 请求体参数
- 所有POST/PUT请求使用JSON格式
- 日期时间格式：`YYYY-MM-DD HH:mm:ss`
- 日期格式：`YYYY-MM-DD`

## 数据类型

### 基础数据类型
- `string`: 字符串
- `number`: 数字
- `boolean`: 布尔值
- `array`: 数组
- `object`: 对象

### 特殊数据类型
- `timestamp`: 时间戳，毫秒级
- `date`: 日期，YYYY-MM-DD格式
- `datetime`: 日期时间，YYYY-MM-DD HH:mm:ss格式
- `phone`: 手机号，11位数字
- `email`: 邮箱地址

## 状态说明

### 用户状态
- `0`: 未激活
- `1`: 正常
- `2`: 已禁用
- `3`: 已注销

### 车辆状态
- `0`: 不可用
- `1`: 可用
- `2`: 维护中
- `3`: 已预订
- `4`: 使用中

### 订单状态
- `0`: 待支付
- `1`: 已支付
- `2`: 进行中
- `3`: 已完成
- `4`: 已取消
- `5`: 退款中
- `6`: 已退款

### 支付状态
- `0`: 待支付
- `1`: 支付成功
- `2`: 支付失败
- `3`: 已退款

## 接口分类

### 1. 认证接口
- 用户登录/注册
- Token刷新
- 获取用户信息

### 2. 用户接口
- 用户信息管理
- 实名认证
- 收货地址管理

### 3. 车辆接口
- 车辆列表查询
- 车辆详情
- 车辆筛选和搜索

### 4. 订单接口
- 订单创建
- 订单列表
- 订单详情
- 订单状态更新

### 5. 支付接口
- 创建支付
- 支付结果查询
- 退款申请

### 6. 门店接口
- 门店列表
- 门店详情
- 门店车辆查询

### 7. 营销接口
- 优惠券列表
- 优惠券领取和使用

### 8. 评价接口
- 评价列表
- 创建评价
- 评价回复

## 开发工具

### Postman集合
提供完整的Postman集合，包含所有接口的示例请求。

### SDK
提供JavaScript/TypeScript SDK，简化API调用：

```javascript
import { DaodaoAPI } from '@daodao/api-sdk'

const api = new DaodaoAPI({
  baseURL: 'http://localhost:3001',
  token: 'your-jwt-token'
})

const vehicles = await api.vehicles.getList()
```

## 测试环境

### Mock服务
开发环境可使用Mock服务进行接口测试：
- 地址：`http://localhost:3001`
- 功能：提供完整的Mock数据和接口

### 在线测试
提供在线API测试工具：
- 地址：`http://localhost:3001/api-tester`
- 功能：可视化接口测试

## 版本控制

API版本通过URL路径控制：
- v1: `/api/v1/` - 当前版本
- v2: `/api/v2/` - 下一个主要版本

版本更新策略：
- 向后兼容的更新不会改变版本号
- 破坏性更新会增加主版本号
- 旧版本会维护6个月的兼容期

## 技术支持

### 问题反馈
- 邮箱：api-support@daodao.com
- 问题跟踪：GitHub Issues

### 开发交流
- QQ群：123456789
- 微信群：扫描二维码加入

## 更新日志

### v1.0.0 (2025-11-24)
- 初始版本发布
- 实现基础认证、用户、车辆、订单接口
- 完善错误码体系和响应格式

---

**注意**:
1. 所有接口都支持跨域请求（CORS）
2. 敏感数据传输建议使用HTTPS
3. 生产环境需要配置请求频率限制
4. 请定期更新Token以保持会话有效