# 叨叨房车项目类型定义统一说明

> **文档版本**: v1.0
> **创建日期**: 2025-12-24
> **文档说明**: 本文档说明前端代码中类型定义的统一规范,以小程序端为准

---

## 一、统一原则

### 1.1 基本原则
1. **以小程序端为准**: 所有枚举值和类型定义以小程序端实际使用为准
2. **保持一致性**: 两端的类型定义必须保持一致
3. **使用驼峰命名**: 字段命名统一使用驼峰命名法
4. **完整注释**: 所有类型定义必须添加完整的注释

### 1.2 文件组织
- 小程序端: `miniprogram/types/`
- PC管理端: `admin-console/src/types/`
- 共享类型: 可考虑提取到 `shared/types/`

---

## 二、订单状态枚举统一

### 2.1 订单状态 (OrderStatus)

**统一定义**:
```typescript
export enum OrderStatus {
  PENDING = 'pending',        // 待支付
  PAID = 'paid',             // 已支付
  CONFIRMED = 'confirmed',   // 已确认
  READY = 'ready',           // 待取车
  IN_USE = 'in_use',         // 使用中
  COMPLETED = 'completed',   // 已完成
  CANCELLED = 'cancelled',   // 已取消
  REFUNDED = 'refunded'      // 已退款
}
```

**状态映射**:
```typescript
export const ORDER_STATUS_MAP = {
  [OrderStatus.PENDING]: { code: 'pending', name: '待支付' },
  [OrderStatus.PAID]: { code: 'paid', name: '已支付' },
  [OrderStatus.CONFIRMED]: { code: 'confirmed', name: '已确认' },
  [OrderStatus.READY]: { code: 'ready', name: '待取车' },
  [OrderStatus.IN_USE]: { code: 'in_use', name: '使用中' },
  [OrderStatus.COMPLETED]: { code: 'completed', name: '已完成' },
  [OrderStatus.CANCELLED]: { code: 'cancelled', name: '已取消' },
  [OrderStatus.REFUNDED]: { code: 'refunded', name: '已退款' }
}
```

**应用范围**:
- 小程序端: `miniprogram/types/order.ts`
- PC管理端: `admin-console/src/types/order.ts`
- 数据库: orders 表的 status 字段

---

### 2.2 支付状态 (PaymentStatus)

**订单支付状态汇总**:
```typescript
export enum OrderPaymentStatus {
  UNPAID = 'unpaid',     // 未支付
  PARTIAL = 'partial',   // 部分支付
  PAID = 'paid',         // 已支付
  REFUNDED = 'refunded'  // 已退款
}
```

**支付记录详细状态**:
```typescript
export enum PaymentRecordStatus {
  PENDING = 'pending',       // 待支付
  SUCCESS = 'success',       // 支付成功
  FAILED = 'failed',         // 支付失败
  CANCELLED = 'cancelled',   // 支付取消
  REFUNDING = 'refunding',   // 退款中
  REFUNDED = 'refunded'      // 已退款
}
```

**应用范围**:
- orders 表使用 OrderPaymentStatus
- payments 表使用 PaymentRecordStatus

---

## 三、车辆相关枚举统一

### 3.1 车辆状态 (VehicleStatus)

**统一定义**:
```typescript
export enum VehicleStatus {
  AVAILABLE = 'available',       // 可用
  RENTED = 'rented',            // 已出租
  MAINTENANCE = 'maintenance',   // 维护中
  UNAVAILABLE = 'unavailable'    // 不可用
}
```

**状态映射**:
```typescript
export const VEHICLE_STATUS_MAP = {
  [VehicleStatus.AVAILABLE]: { code: 'available', name: '可用' },
  [VehicleStatus.RENTED]: { code: 'rented', name: '已出租' },
  [VehicleStatus.MAINTENANCE]: { code: 'maintenance', name: '维护中' },
  [VehicleStatus.UNAVAILABLE]: { code: 'unavailable', name: '不可用' }
}
```

---

### 3.2 车辆类型 (VehicleType)

**统一定义**:
```typescript
export enum VehicleType {
  MOTORHOME = 'motorhome',   // 自行式房车
  TRAILER = 'trailer',       // 拖挂式房车
  CAMPER_VAN = 'camper_van', // 露营车
  RV = 'rv'                  // 休闲车
}
```

---

### 3.3 变速箱类型 (Transmission)

**统一定义**:
```typescript
export enum Transmission {
  MANUAL = 'manual',       // 手动
  AUTOMATIC = 'automatic'  // 自动
}
```

---

### 3.4 燃料类型 (FuelType)

**统一定义**:
```typescript
export enum FuelType {
  GASOLINE = 'gasoline',  // 汽油
  DIESEL = 'diesel',      // 柴油
  HYBRID = 'hybrid',      // 混合动力
  ELECTRIC = 'electric'   // 电动
}
```

---

## 四、托管相关枚举统一

### 4.1 托管类型 (HostingType)

**统一定义**:
```typescript
export enum HostingType {
  OWN_VEHICLE = 'own_vehicle',           // 自有车托管
  PURCHASE_VEHICLE = 'purchase_vehicle'  // 购车托管
}
```

---

### 4.2 托管申请状态 (HostingApplicationStatus)

**统一定义**:
```typescript
export enum HostingApplicationStatus {
  PENDING = 'pending',     // 待审核
  APPROVED = 'approved',   // 已通过
  REJECTED = 'rejected'    // 已拒绝
}
```

---

### 4.3 托管车辆状态 (HostingVehicleStatus)

**统一定义**:
```typescript
export enum HostingVehicleStatus {
  ACTIVE = 'active',         // 运营中
  PAUSED = 'paused',         // 暂停
  TERMINATED = 'terminated'  // 已终止
}
```

---

### 4.4 提现状态 (WithdrawalStatus)

**统一定义**:
```typescript
export enum WithdrawalStatus {
  PENDING = 'pending',       // 待审核
  APPROVED = 'approved',     // 已通过
  REJECTED = 'rejected',     // 已拒绝
  COMPLETED = 'completed'    // 已完成
}
```

---

## 五、用户相关枚举统一

### 5.1 用户类型 (UserType)

**统一定义**:
```typescript
export enum UserType {
  CUSTOMER = 'customer',         // C端用户
  MOBILE_ADMIN = 'mobile_admin', // 移动管理员
  PC_ADMIN = 'pc_admin'          // PC管理员
}
```

---

### 5.2 用户状态 (UserStatus)

**统一定义**:
```typescript
export enum UserStatus {
  ACTIVE = 'active',     // 激活
  INACTIVE = 'inactive', // 未激活
  BANNED = 'banned'      // 禁用
}
```

---

### 5.3 会员类型 (MembershipTier)

**统一定义**:
```typescript
export enum MembershipTier {
  REGULAR = 'regular',  // 普通会员
  PLUS = 'plus'         // PLUS会员
}
```

---

## 六、实施步骤

### 6.1 第一步: 创建统一的枚举定义文件

**小程序端**:
- 创建 `miniprogram/types/enums.ts`
- 定义所有枚举类型
- 导出枚举和映射

**PC管理端**:
- 创建 `admin-console/src/types/enums.ts`
- 复制小程序端的枚举定义
- 保持完全一致

---

### 6.2 第二步: 更新现有类型定义文件

**需要更新的文件**:
- `miniprogram/types/order.ts`
- `miniprogram/types/hosting.ts`
- `admin-console/src/types/order.ts`
- `admin-console/src/types/hosting.ts`

**更新内容**:
- 导入统一的枚举定义
- 替换现有的字符串字面量类型
- 添加完整的注释

---

### 6.3 第三步: 更新API接口定义

**需要更新的文件**:
- `miniprogram/api/*.ts`
- `admin-console/src/api/*.ts`

**更新内容**:
- 使用统一的枚举类型
- 确保请求和响应类型一致

---

### 6.4 第四步: 验证编译

**验证步骤**:
1. 编译小程序端: `cd miniprogram && npm run type-check`
2. 编译PC管理端: `cd admin-console && npm run type-check`
3. 修复编译错误
4. 确保所有类型检查通过

---

## 七、注意事项

### 7.1 向后兼容
- 保留旧的类型定义一段时间
- 提供类型转换函数
- 逐步迁移现有代码

### 7.2 代码审查
- 所有类型定义变更需要代码审查
- 确保两端类型定义一致
- 验证业务逻辑正确性

### 7.3 文档更新
- 更新API文档
- 更新开发文档
- 更新数据字典

---

**文档结束**
